# バッチファイルで複数のExcelファイルを一括で開く方法

毎日複数のExcelファイルを開いて作業していますか？同じファイルを何度も探して開くのは面倒ですよね。バッチファイルを使えば、ワンクリックで複数のExcelファイルを一度に開くことができます。この記事では、バッチファイルの基本から、複数のExcelファイルを簡単に開く方法まで解説します。

## バッチファイルとは？

バッチファイルとは、Windowsのコマンドプロンプトで実行する命令を記述したテキストファイルです。拡張子は「.bat」で、ダブルクリックするだけで中に書かれたコマンドが順番に実行されます。普段手作業で行っている操作を自動化するのに適しています。

## 複数のExcelファイルを開くバッチファイル

以下のコードをメモ帳などのテキストエディタにコピーし、「excel_opener.bat」という名前で保存してください。

```batch
@echo off
REM Excelを使って指定したファイルを開くバッチファイル
REM 以下に開きたいExcelファイルのパスを入力してください（複数可）
set EXCEL_FILES=C:\Users\hogehoge\Downloads\test2\test2excel.xlsx C:\Users\hogehoge\Downloads\test1\test1excel.xlsx
REM Excelで開く
for %%f in (%EXCEL_FILES%) do (
    echo %%fを開いています...
    start "" "%%f"
)
echo 完了しました！
```

## コード解説

このバッチファイルがどのように動作するのか、1行ずつ解説します。

1. **`@echo off`**  
   コマンドの実行内容を画面に表示しないようにします。これにより、結果だけが表示されます。

2. **`REM Excelを使って指定したファイルを開くバッチファイル`**  
   コメント行です。バッチファイルの目的を説明しています。実際の処理は行いません。

3. **`REM 以下に開きたいExcelファイルのパスを入力してください（複数可）`**  
   これもコメント行です。バッチファイルを編集する人への指示を記載しています。

4. **`set EXCEL_FILES=C:\Users\hogehoge\Downloads\test2\test2excel.xlsx C:\Users\hogehoge\Downloads\test1\test1excel.xlsx`**  
   `EXCEL_FILES`という変数に、開きたいExcelファイルのパスを設定します。複数のファイルはスペースで区切ります。

5. **`REM Excelで開く`**  
   これもコメント行です。次の処理内容を説明しています。

6. **`for %%f in (%EXCEL_FILES%) do (`**  
   `EXCEL_FILES`変数に設定された各ファイルに対してループ処理を行います。各ファイルパスは一時的に`%%f`という変数に格納されます。

7. **`echo %%fを開いています...`**  
   現在処理中のファイル名を画面に表示します。

8. **`start "" "%%f"`**  
   Windowsの関連付けられたプログラム（この場合はExcel）でファイルを開きます。最初の`""`は空のウィンドウタイトルを指定し、`"%%f"`は開くファイルのパスです。

9. **`)`**  
   forループの終了を示します。

10. **`echo 完了しました！`**  
    すべてのファイルを開き終わったら「完了しました！」と表示します。

## 複数のファイルパスを指定する方法

### 基本的な方法
```batch
set EXCEL_FILES=C:\path\to\file1.xlsx C:\path\to\file2.xlsx C:\path\to\file3.xlsx
```
ファイルパスはスペースで区切って指定します。

### パスにスペースが含まれる場合
```batch
set EXCEL_FILES="C:\My Documents\file1.xlsx" "D:\Work Files\file2.xlsx"
```
パスにスペースが含まれる場合は、パス全体を引用符（`"`）で囲みます。

### 長いパスリストを見やすくする方法
```batch
set EXCEL_FILES=^
C:\path\to\file1.xlsx ^
C:\path\to\file2.xlsx ^
C:\path\to\file3.xlsx
```
行末にキャレット（`^`）を置くことで、コマンドを複数行に分割できます。これにより、長いパスリストを見やすく管理できます。

## 応用例：フォルダ内のすべてのExcelファイルを開く

特定のフォルダ内にあるすべてのExcelファイルを開きたい場合は、以下のようなバッチファイルが便利です。

```batch
@echo off
REM フォルダ内のすべてのExcelファイルを開く
set EXCEL_FOLDER=C:\Users\hogehoge\Downloads\test1
for %%f in ("%EXCEL_FOLDER%\*.xlsx") do (
    echo %%fを開いています...
    start "" "%%f"
)
echo 完了しました！
```

このバッチファイルでは、`EXCEL_FOLDER`で指定したフォルダ内にある拡張子が.xlsxのファイルをすべて開きます。`*.xlsx`はワイルドカードで、「任意の名前」+「.xlsx」というパターンにマッチするファイルをすべて選択します。

## 応用例：複数のフォルダからExcelファイルを開く

複数のフォルダからExcelファイルを開きたい場合は、以下のようなバッチファイルが使えます。

```batch
@echo off
REM 複数のフォルダからExcelファイルを開く
set FOLDERS=C:\Users\hogehoge\Downloads\test1 C:\Users\hogehoge\Downloads\test2
for %%d in (%FOLDERS%) do (
    for %%f in ("%%d\*.xlsx") do (
        echo %%fを開いています...
        start "" "%%f"
    )
)
echo 完了しました！
```

このバッチファイルでは、まずフォルダのリスト（`FOLDERS`）をループし、次に各フォルダ内のExcelファイルをループして開きます。

## バッチファイルの活用例

- **朝の業務開始時**：毎朝確認する複数の売上レポートやデータファイルを一括で開く
- **定例会議の準備**：会議資料として使う複数のExcelファイルを一度に開く
- **データ入力作業**：複数の入力用シートを同時に開いて作業効率を上げる
- **バックアップ確認**：複数のバックアップファイルを一度に開いて内容を確認する

## まとめ

バッチファイルを使うことで、複数のExcelファイルを一度に開く作業を自動化できます。ファイルパスを変更するだけで簡単にカスタマイズでき、日々の業務効率を大幅に向上させることができます。特に毎日同じファイルを開く必要がある場合、このようなバッチファイルを作成しておくと便利です。

デスクトップにバッチファイルのショートカットを置いておけば、ワンクリックで必要なファイルがすべて開き、すぐに作業を始められます。この機会にぜひバッチファイルを作成して、Excelでの作業を効率化してみてください。
